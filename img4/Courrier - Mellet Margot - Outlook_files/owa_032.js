self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ConversationAttachment.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[186],{1032:function(e,t,n){var r=n(1197),a=36e5,o=6e4,i=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,p=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,f=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,_=/([Z+-].*)$/,j=/^(Z)$/,I=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?i:Number(n);var y=function(e){var t,n={},r=e.split(c);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=_.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),S=function(e,t){var n,r=d[t],a=p[t];if(n=l.exec(e)||a.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=u.exec(e)||r.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(y.date,n),A=S.year,D=function(e,t){if(null===t)return null;var n,r,a,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=f.exec(e)){r=new Date(0);var i=parseInt(n[1],10);return r.setUTCFullYear(t,0,i),r}if(n=h.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=v.exec(e))return o=parseInt(n[1],10)-1,C(t,o);if(n=b.exec(e)){o=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return C(t,o,s)}return null}(S.restDateString,A);if(D){var E,P=D.getTime(),T=0;return y.time&&(T=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=O.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*o;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*a+r*o+1e3*i}return null}(y.time)),y.timezone?(k=y.timezone,E=(M=j.exec(k))?0:(M=I.exec(k))?(N=60*parseInt(M[2],10),"+"===M[1]?-N:N):(M=x.exec(k))?(N=60*parseInt(M[2],10)+parseInt(M[3],10),"+"===M[1]?-N:N):0):(E=new Date(P+T).getTimezoneOffset(),E=new Date(P+T+E*o).getTimezoneOffset()),new Date(P+T+E*o)}var k,M,N;return new Date(e)}},1077:function(e,t,n){"use strict";var r,a;function o(e){r=e}function i(){return r}function c(e){a=e}function s(){return a}n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return s})},1114:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(2440),a="fileType-icon";function o(e){return r[function(e){return a+"-"+e}(e)]}},1133:function(e,t,n){"use strict";var r=n(2441),a=n(1943),o=n(2590),i=n(43);t.a=Object(i.action)("setOngoingActionAndActionMessage")(function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(o.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)})},1176:function(e,t,n){"use strict";var r=n(0),a=n(2470),o=n(1981),i=n(1133),c={},s=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(function(){return e.updatePropertyHandler(1.1)},500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function u(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function d(e,t,n,r){var a=new s(e,t,n);c[r.Id]=a,a.start()}var l=n(2971),p=n(2);Object(p.orchestrator)(a.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:a=e.attachment,Object(i.a)(a,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,a){u(e,!0),Object(o.a)(n,a),Object(i.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var a})})});var m=n(931),f=n(2685),h=n(3099),v=n.n(h),b=n(3844),g=n.n(b);function O(e,t,n,r,a){var o=function(e,t,n,r,a){return v()({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return g()({requestObject:o})}var w=n(228),_=n(813),j=n(2504),I=n(1051),x=n(43),C={},y=Object(x.action)("convertClassicToCloudy")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=new w.a("AttachmentConvertClassicToCloudy"),function(e){Object(i.a)(e,5,8)}(e),o=function(t){if(A(e,t.ResultCode),D(a,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){A(e,1),n(!1,null),D(a,e.attachmentId,1,t)},[4,S(e.attachmentId,t,o,c)];case 1:return r.sent(),[2]}})})});function S(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,i,c,s,u,d;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,Object(j.a)(n)];case 1:o=r.__read.apply(void 0,[l.sent(),4]),i=o[0],c=o[1],s=o[2],u=o[3],C[e.Id]=i,l.label=2;case 2:return l.trys.push([2,4,,5]),[4,O(e.Id,t,i,u,i)];case 3:return l.sent(),[3,5];case 4:return d=l.sent(),a(d.message),I.g.importAndExecute(c,s),[3,5];case 5:return[2]}})})}function A(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,9)}delete C[e.attachmentId.Id]}function D(e,t,n,r){var a=Object(_.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var E={name:"CancelConvertClassicToCloudy"},P={name:"CancelConvertCloudyToClassic"},T=n(3100),k=n.n(T),M=n(3845),N=n.n(M);function V(e){var t=function(e){return k()({cancellationId:e})}(e);return N()(t)}var L=n(30),R=Object(L.b)("cancelConvertClassicToCloudy",E)(function(e){var t,n=(t=e.attachmentId.Id,C[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(i.a)(e,5,10),V(n)}),H=n(2003),F=Object(x.action)("setActionCompletePercent")(function(e,t){e.actionCompletePercent=t}),z=n(2672),B=n(2165),U=(n(1943),n(1591)),W=n(2296),X=n(881),Y=n(2499),q=n(2829),J=n(3337),G=n(985),K=Object(x.action)("updateAttachment")(function(e,t,n,a,o){Object(q.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},a.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,a.Name&&(n.Name=a.Name),a.Size&&(n.Size=a.Size),a.ContentType&&(n.ContentType=a.ContentType),a.__type&&(n.__type=a.__type),n.IsInline&&(n.ContentId=a.ContentId),Object(G.b)(a)){var s=n;s.AttachLongPathName=a.AttachLongPathName,s.PermissionType=a.PermissionType,s.ProviderType=a.ProviderType,s.AttachmentThumbnailUrl=a.AttachmentThumbnailUrl,s.AttachmentPreviewUrl=a.AttachmentPreviewUrl}if(Object(Y.a)([{attachmentId:c,attachment:n,permissionInfo:o}],!1),e.attachmentId=c,Object(W.a)(e))Object(B.a)(e,1);else{Object(X.g)(e,!1),setTimeout(function(){F(e,1.1)},500),Object(i.a)(e,0,0);var u=Object(_.a)(c);Object(U.a)(e,u,!1,e.strategy.supportedMenuActions),u.download.url||Object(J.a)(c,e.isReadOnly,!0)}}),Q=n(3101),Z=n.n(Q),$=n(3846),ee=n.n($);function te(e,t,n,r,a,o,i,c){var s=function(e,t,n,r,a,o,i,c){return Z()({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:o,attachmentDataProviderId:c,PermissionLevel:i})}(e,t,n,r,a,o,i,c);return ee()({requestObject:s})}function ne(e){return ce(Object(_.a)(e).model.Size)}function re(e){return 2856+.00145*e}function ae(e){return 4*ce(e)}function oe(e){return 4*ce(e)}function ie(e){return 2*ce(e)}function ce(e){return Math.round(e/256)}var se=n(3102),ue=n.n(se),de={},le=Object(p.action)("convertCloudyToClassic",function(e,t,n,r,a,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:o}}),pe=le;function me(e,t,n,a,o,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var c,s,u,d,l,p;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return[4,Object(j.a)(o)];case 1:c=r.__read.apply(void 0,[m.sent(),4]),s=c[0],u=c[1],d=c[2],l=c[3],de[e.Id]=s,m.label=2;case 2:return m.trys.push([2,4,,5]),[4,te(e.Id,t,s,l,s,n,a)];case 3:return m.sent(),[3,5];case 4:return p=m.sent(),i(p.message),I.g.importAndExecute(u,d),[3,5];case 5:return[2]}})})}function fe(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,12)}delete de[e.attachmentId.Id]}function he(e,t,n,r,a){var o=Object(_.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:o.model.AttachmentId&&o.model.AttachmentId.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}Object(p.orchestrator)(le,function(e){var t=e.attachment;!function(e,t,n,a,o,c){Object(r.__awaiter)(this,void 0,void 0,function(){var s,u,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s=new w.a("AttachmentConvertCloudyToClassic"),function(e){Object(i.a)(e,6,11)}(e),u=function(t){if(fe(e,t.ResultCode),he(s,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=ue()({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},d=function(t){fe(e,1),o(!1,null),he(s,e.attachmentId,1,t,c)},[4,me(e.attachmentId,t,n,a,u,d)];case 1:return r.sent(),[2]}})})}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):u(t.attachmentId,n)},e.source),d(ne(t.attachmentId),.1,function(e){F(t,e)},t.attachmentId)});var ve=n(3103),be=n.n(ve),ge=n(3847),Oe=n.n(ge);function we(e){var t=function(e){return be()({cancellationId:e})}(e);return Oe()(t)}var _e=Object(p.action)("cancel_ConvertCloudyToClassic",function(e){return Object(L.a)(P,{attachmentViewState:e})}),je=_e;Object(p.orchestrator)(_e,function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,de[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(i.a)(e.attachmentViewState,6,10),we(n)});var Ie=n(982),xe=n(1397),Ce=n(829);function ye(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,xe.h.import()];case 1:return n.sent()(e.model.AttachLongPathName).then(function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(Ie.f)(e.model,!0),[4,Ce.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return a=r.sent(),Ce.m.importAndExecute(e.id,a),Object(Ce.p)(e.id),[2]}})})}),[2]}})})}var Se=n(2295),Ae=n(911);function De(e,t,n,r,a){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===a&&(a=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:Ae.a.Inline,skipProcessInlineImage:a}}function Ee(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}n.d(t,"a",function(){return m.a}),n.d(t,"g",function(){return f.a}),n.d(t,"b",function(){return R}),n.d(t,"d",function(){return y}),n.d(t,"s",function(){return H.a}),n.d(t,"u",function(){return H.c}),n.d(t,"t",function(){return H.b}),n.d(t,"v",function(){return F}),n.d(t,"w",function(){return z.a}),n.d(t,"x",function(){return B.a}),n.d(t,"y",function(){return i.a}),n.d(t,"B",function(){return K}),n.d(t,"p",function(){return U.a}),n.d(t,"m",function(){return U.b}),n.d(t,"c",function(){return je}),n.d(t,"e",function(){return pe}),n.d(t,"l",function(){return ye}),n.d(t,"z",function(){return d}),n.d(t,"A",function(){return u}),n.d(t,"j",function(){return re}),n.d(t,"k",function(){return oe}),n.d(t,"o",function(){return ae}),n.d(t,"i",function(){return ie}),n.d(t,"f",function(){return Se.a}),n.d(t,"h",function(){return De}),n.d(t,"n",function(){return ne}),n.d(t,"r",function(){return Ee}),n.d(t,"q",function(){return W.a})},1197:function(e,t){e.exports=function(e){return e instanceof Date}},12694:function(e,t,n){var r=n(12695),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},12695:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._1pPFwx5rYgxcgAElMzLbAd{display:block;width:261px}html[dir] ._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:focus,html[dir] ._1pPFwx5rYgxcgAElMzLbAd:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1pPFwx5rYgxcgAElMzLbAd._3JHQes77teu7GToIsCc_xE ._302eciisr8EpJrDSwH_Sbx,._1pPFwx5rYgxcgAElMzLbAd:hover ._302eciisr8EpJrDSwH_Sbx{width:142px}._Y2ypFk_xp-nvQtuGu_-h{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3wcJ_rB4jUxKLkaKrKj_GZ{display:block}html[dir] ._3wcJ_rB4jUxKLkaKrKj_GZ{margin:6px 8px}._2Pr_qifjTGwPB6L_eo24_B{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2Pr_qifjTGwPB6L_eo24_B{background:transparent}._1Ra5rtzVEB6uogdqQiC2rx{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1Ra5rtzVEB6uogdqQiC2rx{padding:6px 4px}._3EsA8G8nIiVlrwi7EvfneN{font-size:14px}._3EsA8G8nIiVlrwi7EvfneN,._302eciisr8EpJrDSwH_Sbx{font-weight:400;max-width:194px}._302eciisr8EpJrDSwH_Sbx{font-size:11px}html[dir] ._302eciisr8EpJrDSwH_Sbx{padding-top:3px}._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-right:4px}html[dir=rtl] ._302eciisr8EpJrDSwH_Sbx .GeukVsgtTix5zrmhP2k1C{padding-left:4px}._302eciisr8EpJrDSwH_Sbx ._1DD8d7Q5IxT7aE8KaVPUKa{color:#107c10}._302eciisr8EpJrDSwH_Sbx ._23Ys9CLV_lGJ3w0LIHTfLi{color:#e81123}._2Tuvy48k5aBpiLeRkrcceY{overflow:hidden;text-overflow:ellipsis}._2aO0rTKW0ac8YNFb8bLNnA{height:26px;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._2aO0rTKW0ac8YNFb8bLNnA{right:0}html[dir=rtl] ._2aO0rTKW0ac8YNFb8bLNnA{left:0}.CO4JS_CRPsg_js1AAXe-d{display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] .CO4JS_CRPsg_js1AAXe-d{right:0}html[dir=rtl] .CO4JS_CRPsg_js1AAXe-d{left:0}html[dir] .CO4JS_CRPsg_js1AAXe-d:focus,html[dir] .CO4JS_CRPsg_js1AAXe-d:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}.GeukVsgtTix5zrmhP2k1C{font-size:14px}html[dir] .GeukVsgtTix5zrmhP2k1C{margin:0}.KLhaPYQ6nYXemE5yXxev7{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] .KLhaPYQ6nYXemE5yXxev7{padding:0 20px 0 54px}html[dir=rtl] .KLhaPYQ6nYXemE5yXxev7{padding:0 54px 0 20px}html[dir] .KLhaPYQ6nYXemE5yXxev7:focus,html[dir] .KLhaPYQ6nYXemE5yXxev7:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1pk_VDuef6gt4o_QRNLHAe{margin-top:-4px}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator-itemName{display:none}._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1pk_VDuef6gt4o_QRNLHAe .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}._3n11Nj1NwjIZ39AgUcDMoH{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._3n11Nj1NwjIZ39AgUcDMoH{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] ._3n11Nj1NwjIZ39AgUcDMoH{left:0}html[dir=rtl] ._3n11Nj1NwjIZ39AgUcDMoH{right:0}',""]),t.locals={container:"_1pPFwx5rYgxcgAElMzLbAd",active:"_3JHQes77teu7GToIsCc_xE",secondLine:"_302eciisr8EpJrDSwH_Sbx",innerContainer:"_Y2ypFk_xp-nvQtuGu_-h",thumbnailDiv:"_3wcJ_rB4jUxKLkaKrKj_GZ",placeholder:"_2Pr_qifjTGwPB6L_eo24_B",infoDiv:"_1Ra5rtzVEB6uogdqQiC2rx",firstLine:"_3EsA8G8nIiVlrwi7EvfneN",icon:"GeukVsgtTix5zrmhP2k1C",success:"_1DD8d7Q5IxT7aE8KaVPUKa",failure:"_23Ys9CLV_lGJ3w0LIHTfLi",textOverFlow:"_2Tuvy48k5aBpiLeRkrcceY",actionsContainer:"_2aO0rTKW0ac8YNFb8bLNnA",menuButton:"CO4JS_CRPsg_js1AAXe-d",menuItem:"KLhaPYQ6nYXemE5yXxev7",progressIndicator:"_1pk_VDuef6gt4o_QRNLHAe",dragPreview:"_3n11Nj1NwjIZ39AgUcDMoH"}},12696:function(e,t,n){var r=n(12697),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},12697:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,"._3h6BOcXe5rgJt2gWiPg7WW{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3h6BOcXe5rgJt2gWiPg7WW"}},12698:function(e){e.exports={a:"XMb"}},12699:function(e,t,n){var r=n(12700),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},12700:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._2I3DVKJX90XpSU9E0jOrPI{color:"[theme:neutralDark, default:#212121]"}html[dir] ._2I3DVKJX90XpSU9E0jOrPI{border-radius:2px;border-color:transparent}html[dir] ._2I3DVKJX90XpSU9E0jOrPI:not(:hover){background-color:transparent}._2I3DVKJX90XpSU9E0jOrPI.ms-Button{min-width:50px}html[dir] ._2I3DVKJX90XpSU9E0jOrPI.ms-Button{padding:0}html[dir=ltr] .jflLAFNOz_OPbbqzYM9gl{margin-left:2px}html[dir=rtl] .jflLAFNOz_OPbbqzYM9gl{margin-right:2px}._1kEgpc1Wh6CbzQbd6iET2p{font-size:10px}html[dir] ._1kEgpc1Wh6CbzQbd6iET2p{margin:2px 6px 0 6px}._3JXvFMglzZ7tMbYPkjKuKC{font-size:14px;font-weight:400}html[dir] ._3JXvFMglzZ7tMbYPkjKuKC{margin:0}',""]),t.locals={button:"_2I3DVKJX90XpSU9E0jOrPI",icon:"jflLAFNOz_OPbbqzYM9gl",menuIcon:"_1kEgpc1Wh6CbzQbd6iET2p",label:"_3JXvFMglzZ7tMbYPkjKuKC"}},1296:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=5,a="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},1302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},1333:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,a=n(992),o=n(1351);function i(e,t,n,i,c){if(n)return r=r||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return i?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},1351:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=1;function a(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},13925:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(173),o=n(281),i=n(716),c=n(86),s=n(228),u=n(2672),d=n(2),l=Object(d.mutatorAction)("setConversationAttachmentWellVisible",function(e,t){e.isVisible=t}),p=n(4),m=n(7392),f=n(1),h=n(6329),v=Object(d.mutatorAction)("updateConversationAttachmentWellMaxHeight",function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200}),b=n(8206),g=n(1281),O=n(11),w=n(19),_=n(287),j=n(351),I=n(5058),x=n(77),C=n(881),y=n(5136),S=n(7394),A=n(8222),D=n(7637),E=n(829),P=n(813),T=n(2862),k=n(3770),M=n(1412),N=n(836),V=n(105),L=n(788),R=n(1535),H=n(5794),F=n(364),z=n(877),B=n(25),U=n(12694),W=n(240).bind(U),X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyDown=function(e){e.keyCode!==x.a.enter&&e.keyCode!==x.a.space||t.onClick()},t.onClick=function(e){var n=Object(C.e)(t.props.attachmentViewState.strategy);if(n!==C.a.NoAction){var r=S.c.OnClick,a=r.name,o=r.customData;Object(s.o)(a,o(n)),Object(T.c)(t.props.attachmentViewState,z.c.ConversationAttachmentWell,t.props.instrumentationContext,t.props.parentItemId,!1,t.props.onBeforePreview,t.props.createImageGallery,t.containerElement.parentElement)}},t.onContextMenu=function(e){e.preventDefault(),Object(u.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!0)},t.onMenuButtonClicked=function(e){e.stopPropagation(),Object(u.a)(t.props.attachmentViewState,t.contextMenuJustOpened=!t.props.attachmentViewState.shouldShowContextMenu)},t.onContainerElementUpdate=function(e){t.containerElement=e},t.onFocusOrMouseOver=function(){t.props.onFocus&&t.props.onFocus(t.props.attachmentViewState.attachmentId.Id)},t.canDrag=function(){return!!Object(P.a)(t.props.attachmentViewState.attachmentId)&&Object(V.e)("doc-attachment-convoWellDragDrop")},t.getAttachmentDragData=function(){var e=Object(P.a)(t.props.attachmentViewState.attachmentId).model,n=Object(y.a)(e);return{itemType:N.a.Attachment,attachmentFile:n}},t.getDragPreview=function(){var e=document.createElement("div");return e.className=U.dragPreview,e.innerText=Object(P.a)(t.props.attachmentViewState.attachmentId).model.Name,e},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=Object(P.a)(this.props.attachmentViewState.attachmentId),t=13===e.attachmentClass&&Object(V.e)("cal-ics-preview");return f.createElement("div",{"aria-label":e.model.Name,ref:this.onContainerElementUpdate,onFocus:this.onFocusOrMouseOver,onKeyDown:this.keyDown,onMouseOver:this.onFocusOrMouseOver,className:W(U.container,{active:this.props.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:this.onClick,onContextMenu:this.onContextMenu},f.createElement(M.b,{canDrag:this.canDrag,getDragData:this.getAttachmentDragData,getDragPreview:this.getDragPreview,xOffset:-12,yOffset:5},f.createElement("div",{className:U.innerContainer},this.renderIcon(e),this.renderInfo(e),this.props.attachmentViewState.strategy.showActionsMenu&&this.props.attachmentViewState.shouldShowActionsContainer&&f.createElement("div",{className:U.actionsContainer},f.createElement(S.a,{attachmentViewState:this.props.attachmentViewState,isForImageView:!1,previewState:z.a.None,shouldNotHandleOnBlur:!0,isForAddToCalendar:t}),f.createElement(_.a,{"data-is-focusable":!1,className:U.menuButton,onClick:this.onMenuButtonClicked,title:Object(p.a)(H.a),ariaLabel:Object(p.a)(H.a),onKeyDown:this.keyDownForMenuButton,iconProps:{iconName:this.props.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:U.icon}}})))),this.renderProgressIndicator(),this.props.attachmentViewState.shouldShowContextMenu?this.renderContextMenu(e):null)},t.prototype.renderIcon=function(e){var t=E.o.tryImportForRender();if(t&&t(e.model)){var n=e.model.Name,r=Object(R.e)(n),a=null,o=Object(O.getIconClassName)("Photo2");return Object(L.f)(n)&&(a=r.small,o=r.small),f.createElement("div",{className:U.thumbnailDiv},f.createElement(k.c,{attachmentViewState:this.props.attachmentViewState,placeHolderCSSClass:W(o,U.placeholder),fileIconCssClass:a,imageLoadErrorCSSClass:r.small,thumbnailWidth:32,thumbnailHeight:32}))}return f.createElement(k.b,{attachmentId:this.props.attachmentViewState.attachmentId})},t.prototype.renderInfo=function(e){var t=1!==e.type&&0===this.props.attachmentViewState.actionMessage?{text:Object(F.a)(this.props.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(A.a)(this.props.attachmentViewState,e);return f.createElement("div",{className:U.infoDiv},f.createElement("div",{className:W(U.firstLine,U.textOverFlow),title:e.model.Name},e.model.Name),f.createElement("div",{className:W(U.secondLine,U.textOverFlow),title:t.title},t.shouldDisplaySuccessIcon?f.createElement(j.a,{iconName:"Accept",className:W(U.icon,U.success)}):null,t.shouldDisplayFailureIcon?f.createElement(j.a,{iconName:"Cancel",className:W(U.icon,U.failure)}):null,t.text))},t.prototype.renderContextMenu=function(e){var t=this,n=S.d.tryImportForRender(),r=n?n(this.props.attachmentViewState,e,{viewState:this.props.attachmentViewState,previewPaneSelectionSource:z.c.ConversationAttachmentWell,parentItemId:this.props.parentItemId,isDraft:!1,onBeforePreview:this.props.onBeforePreview,createImageGallery:this.props.createImageGallery,instrumentationContext:this.props.instrumentationContext},this.props.parentItemId,null,this.containerElement.parentElement,null):[];return f.createElement("div",null,r.map(function(e){return f.createElement(Y,{key:e.key,attachmentViewState:t.props.attachmentViewState,menuItem:e})}))},t.prototype.renderProgressIndicator=function(){return Object(D.a)(this.props.attachmentViewState)?f.createElement("div",{className:U.progressIndicator},f.createElement(I.a,{percentComplete:this.props.attachmentViewState.actionCompletePercent})):null},t.prototype.componentDidUpdate=function(e,t){if(this.contextMenuJustOpened&&(this.contextMenuJustOpened=!1,this.props.attachmentViewState.shouldShowContextMenu)){var n=this.containerElement.parentElement.clientHeight,r=this.containerElement.parentElement.scrollTop,a=this.containerElement.offsetHeight,o=this.containerElement.offsetTop;a+o>n+r?this.containerElement.parentElement.scrollTop=a+o-n:o<r&&(this.containerElement.parentElement.scrollTop=o)}},t.prototype.keyDownForMenuButton=function(e){e.keyCode!==x.a.enter&&e.keyCode!==x.a.space||(B.d.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())},t=Object(r.__decorate)([a.observer],t)}(f.Component),Y=Object(w.a)(function(e){var t=f.useCallback(function(t){t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(u.a)(e.attachmentViewState,!1)},[e.menuItem,e.attachmentViewState]),n=f.useCallback(function(t){t.keyCode!==x.a.enter&&t.keyCode!==x.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(u.a)(e.attachmentViewState,!1))},[e.menuItem,e.attachmentViewState]);return f.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:U.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}),q=n(12696),J=n(240).bind(q),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onItemFocused=function(e){t.props.viewState.docViewAttachments.forEach(function(t){Object(h.a)(t,t.attachmentId.Id===e),t.shouldShowContextMenu&&t.attachmentId.Id!==e&&Object(u.a)(t,!1)})},t.onResize=function(){v(t.props.viewState)},t.createImageGallery=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,Object(b.a)(this.props.viewState,!0)]})})},t}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.onResize(),g.a.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){g.c.importAndExecute(this.onResize)},t.prototype.render=function(){var e=this;return f.createElement("div",{className:J("disableTextSelection","customScrollBar",q.container),style:{maxHeight:this.props.viewState.maxHeight+"px"}},this.props.viewState.docViewAttachments.map(function(t){return f.createElement(X,{key:"convoWell_"+t.attachmentId.Id,attachmentViewState:t,parentItemId:e.props.viewState.parentItemIdMap[t.attachmentId.Id],itemReceivedTime:e.props.viewState.itemReceivedTimeMap[t.attachmentId.Id],instrumentationContext:e.props.instrumentationContext,onBeforePreview:e.props.onBeforePreview,onFocus:e.onItemFocused,createImageGallery:e.createImageGallery})}))},t=Object(r.__decorate)([a.observer],t)}(f.Component),K=n(12698),Q=n(12699),Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataPointLogged=!1,t.onComponentMountOrUpdate=function(){!t.dataPointLogged&&t.props.viewState.docViewAttachments.length>0&&(t.dataPointLogged=!0,Object(s.o)("ConversationAttachmentWellButtonShown"))},t.dismissCallout=function(){l(t.props.viewState,!1),t.props.viewState.docViewAttachments.forEach(function(e){Object(u.a)(e,!1)})},t.onShowMenuClicked=function(){t.props.viewState.isVisible?t.dismissCallout():(l(t.props.viewState,!0),Object(s.o)("ConversationAttachmentWellButtonClicked",null,{cosmosOnlyData:JSON.stringify({numberOfAttachments:t.props.viewState.docViewAttachments.length})}))},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.viewState.docViewAttachments.length;if(0===t)return null;var n=t+(this.props.canLoadMore?"+":"");return f.createElement("div",{className:this.props.className||""},f.createElement("div",{ref:function(t){return e.buttonElement=t}},f.createElement(o.a,{onClick:this.onShowMenuClicked,text:n,className:Q.button,iconProps:{iconName:"Attach",styles:{root:Q.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:Q.menuIcon}},ariaLabel:this.getAriaLabel(),styles:{label:Q.label}})),this.props.viewState.isVisible?f.createElement(i.a,{setInitialFocus:!0,isBeakVisible:!1,target:this.buttonElement,onDismiss:this.dismissCallout,directionalHint:c.a.bottomRightEdge},f.createElement(G,{viewState:this.props.viewState,instrumentationContext:this.props.instrumentationContext,onBeforePreview:this.dismissCallout})):null)},t.prototype.componentDidMount=function(){this.onComponentMountOrUpdate()},t.prototype.componentDidUpdate=function(){this.onComponentMountOrUpdate()},t.prototype.getAriaLabel=function(){var e=this.props.viewState.docViewAttachments.length;return e>1?Object(p.b)(Object(p.a)(m.a),e):Object(p.b)(Object(p.a)(K.a),e)},t=Object(r.__decorate)([a.observer],t)}(f.Component);n.d(t,"ConversationAttachmentWellButton",function(){return Z})},1412:function(e,t,n){"use strict";var r=n(0),a=n(1),o=n(43),i=Object(o.action)("setDragState")(function(e,t){e.isBeingDragged=t}),c=n(1077),s=n(1296),u=n(35),d=n(25);n.d(t,"a",function(){return l});var l=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,r=e?e.dataTransfer.dropEffect:null;(Object(u.d)()||Object(u.f)())&&(r=Object(c.b)()),n&&n(t.props.getDragData(),r)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!s.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,r=e.pageY;(Math.abs(t.initialPageX-n)>=s.b||Math.abs(t.initialPageY-r)>=s.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(u.d)()||Object(u.f)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",function(e){t.onDragStartHelperElement(e)}),t.dragHelperElement.addEventListener("dragend",function(e){t.onDragEnd(e)}),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){if(document.body)document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null);else{var e=t.dragHelperElement?t.dragHelperElement.innerHTML:"null";d.d.error("removeDragHelperElement: "+e)}}}return e.prototype.onUnmount=function(){this.onDragEnd(null),s.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&i(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(c.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&i(this.props.dragViewState,!1),Object(c.c)(null),Object(c.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(s.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){s.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}(),p=function(e){function t(t){var n=e.call(this,t)||this;return n.core=new l(t),n}return Object(r.__extends)(t,e),t.prototype.render=function(){return s.a?a.createElement("div",{draggable:!this.props.isDraggable||this.props.isDraggable(),className:this.props.classNames,ref:this.core.refCallback,onDragStart:this.core.onDragStart,onDragEnd:this.core.onDragEnd},this.props.children):a.createElement("div",{className:this.props.classNames,ref:this.core.refCallback},this.props.children)},t.prototype.componentWillUnmount=function(){this.core.onUnmount()},t.prototype.getDiv=function(){return this.core.getDiv()},t}(a.Component);t.b=p},1477:function(e,t,n){var r=n(1032);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},1535:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1114);n.d(t,"c",function(){return r.a});var a=n(1333);n.d(t,"d",function(){return a.a});var o=n(992);n.d(t,"e",function(){return o.a}),n.d(t,"b",function(){return o.b});var i=n(22),c=new i.c(function(){return n.e(227).then(n.bind(null,2861))}),s=Object(i.d)(c,function(e){return e.CloudIconWithOverlay})},1591:function(e,t,n){"use strict";var r=n(2309),a=n(4),o=n(1981),i=n(1133);var c=n(931),s=n(985),u=n(982),d=n(829),l=n(43);n.d(t,"b",function(){return m});var p=null;function m(){return p||(p=Object.keys(c.a).reduce(function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),p}t.a=Object(l.action)("initializeAttachmentFullViewState")(function(e,t,n,l,p){var f;l&&0!==l.length||(f=t.model,l=Object(d.e)(f)?function(e){return 2===Object(d.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(f):m());var h=Object(u.f)(t.model,!0),v=Object(u.k)(),b=Object(s.a)(t),g=Object(r.a)(v,h,t.attachmentClass,t.model,b?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,l,e.isReadOnly,n,p);e.strategy=g,function(e,t,n){n&&!Object(a.g)(t.model.AttachmentOriginalUrl)&&(Object(o.a)(e,2),Object(i.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)})},1741:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},1807:function(e,t,n){"use strict";var r=n(1068);function a(e){window.open(e,"_blank")}var o=n(35);function i(e,t,n,r){if(t||Object(o.f)())a(e);else{var i=document.createElement("a");i.style.display="none",i.href=e,i.download=r||"",n||(n=document.activeElement&&document.activeElement.parentElement||document.body),n.appendChild(i),i.click(),n.removeChild(i)}}var c=n(985);function s(e,t){i(Object(r.a)(e,t,0,Object(c.b)(t),!1,!0),!1)}var u=n(0),d=n(788),l=n(2265),p=n(2266);function m(e,t){return Object(u.__awaiter)(this,void 0,void 0,function(){var n,a;return Object(u.__generator)(this,function(o){switch(o.label){case 0:return".pdf"!==Object(d.b)(t.Name).toLowerCase()?[3,1]:(n=Object(r.a)(e,t,3,Object(c.b)(t),!1),window.open(n,"_blank"),[3,3]);case 1:return Object(d.e)(t.Name)?[4,Object(l.a)(e,t,Object(c.b)(t))]:[3,3];case 2:a=o.sent(),p.a.importAndExecute(function(e){var t=document.createElement("div"),n=document.createElement("img");return n.src=e,t.appendChild(n),t.innerHTML}(a),"img {max-width: 100%; max-height: 100%; width: auto;  }"),o.label=3;case 3:return[2]}})})}var f=n(2267),h=n(2268),v=n(982);function b(e){var t=Object(v.f)(e,!0),n=Object(d.b)(e.Name);return Object(h.a)(t,e,n)}function g(e){var t=Object(d.b)(e.Name);return b(e)&&t&&(".pdf"===t.toLowerCase()&&Object(f.a)()||Object(d.e)(e.Name))}n.d(t,"a",function(){return s}),n.d(t,"f",function(){return m}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return a})},1870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(1302);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},1871:function(e,t,n){var r=n(1477),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},1943:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setShouldShowImageOverlay")(function(e,t){e.shouldShowImageOverlay=t})},1981:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("addCompletedAction")(function(e,t){e.completedActions.push(t)})},2003:function(e,t,n){"use strict";var r=n(228),a=n(3336),o=n(813),i=n(2542),c=n(3036),s=n(43),u=n(1981),d=n(2309),l=n(1133),p=Object(s.action)("updateIsViewingInProviderSupported")(function(e,t){e.strategy.isViewingInProviderSupported=t});n.d(t,"c",function(){return f}),n.d(t,"b",function(){return h});t.a=Object(s.action)("saveToCloud")(function(e,t,n){var a=new r.a("AttachmentSaveToCloud");f(e);Object(c.b)(e.attachmentId,null,function(r){var o=0===r.ResultCode;return h(e,o,o?r.Item.Location:null),t(o),m(a,e.attachmentId,r.ResultCode,"ServerError",r.Exception,n),!0},function(r,o,i){h(e,!1,null),t(!1),m(a,e.attachmentId,o,i,r,n)})});function m(e,t,n,r,a,c){var s=Object(o.a)(t);e.addCustomData({entryPoint:c,result:n}),e.addCosmosOnlyData(JSON.stringify({size:s.model.Size,fileType:Object(i.a)(s)})),0===n?e.end():e.endWithError(r,new Error(a))}function f(e){Object(l.a)(e,2,1)}function h(e,t,n){if(t){Object(u.a)(e,2),Object(a.a)(e.attachmentId,n);var r=Object(d.b)(!1,!1,n);p(e,r)}Object(l.a)(e,0,t?3:4)}},2165:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setInlineAttachmentStatus")(function(e,t){e.status=t})},2222:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function i(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return i})},2266:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(22),a=new r.c(function(){return n.e(375).then(n.bind(null,3565))}),o=new r.a(a,function(e){return e.print})},2295:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n(881),o=n(911);function i(e,t,n,i,c,s,u){void 0===c&&(c=o.a.Unknown),void 0===s&&(s=!1),void 0===u&&(u=null);var d=Object(a.c)(e,t,i,s,c,u),l=d.strategy;return Object(r.__assign)(Object(r.__assign)({},d),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},2296:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",function(){return r})},2309:function(e,t,n){"use strict";var r=n(0),a=n(4),o=n(982),i=n(931),c=n(218),s=n(881);function u(e){switch(e){case i.a.Download:return s.a.Download;case i.a.OpenInNewTab:return s.a.OpenInNewTab;case i.a.Preview:return s.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function d(e){switch(e){case s.a.Download:return i.a.Download;case s.a.OpenInNewTab:return i.a.OpenInNewTab;case s.a.Preview:return i.a.Preview;case s.a.NoAction:return null;default:return Object(c.a)(e)}}var l=n(1942),p=n(276);var m=Object(l.a)(function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(p.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(c.a)(e)}var t}),f=m.getDataProviderInfo,h=m.getDefaultDataProviderInfo,v=f;var b=n(829);function g(e,t,n,a,i,c,l,p,m,f,h){var g=Object(s.d)(t,n,a,f);!function(e,t){var n=function(e,t,n){void 0===n&&(n=!1);var r=e.filter(function(e){return-1!==t.indexOf(e)});return n&&(r=r.filter(function(e,t,n){return n.indexOf(e)===t})),r}(e.supportedOpenActions.map(d).filter(function(e){return!!e}),t);e.supportedOpenActions=n.map(u)}(g,p);var w,_=function(e){return e.__type===b.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(a),j=f&&function(e){return e.__type===b.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(a),I=Object(o.j)(a,_||j,m,h),x=function(e){return e}(_),C=O(_,j,c),y=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,_||j,m),S=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var o=v(a);return o&&o.supportConvertCloudyToClassic||!1}return!1}(e,_,m,l,i),A=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,_,j,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:w=function(e,t,n,a,o,i,c,s){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:a,isViewingInProviderSupported:o,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:s,showActionsMenu:!0,supportedMenuActions:[]})}(g,I,_||j,x,C,y,S,A);break;case 1:w=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(g);break;default:w=_?function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:a,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,x,C,S):function(e,t,n,a){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(g,I,C,y)}return w.supportedMenuActions=p,w}function O(e,t,n){if(e||t)return!1;var r=Object(p.a)(),o=h(r);return!Object(a.g)(n)&&(r||o&&o.supportViewInProvider)}n.d(t,"a",function(){return g}),n.d(t,"b",function(){return O})},2441:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setOngoingAction")(function(e,t){e.ongoingAction=t})},2470:function(e,t,n){"use strict";var r=n(2),a=n(30),o=Object(r.action)("addCalendarEventsAttachment",function(e,t){return Object(a.a)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})});t.a=o},2504:function(e,t,n){"use strict";var r=n(0),a=n(760),o=n(1051);function i(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=Object(a.a)(),n={subscriptionId:t,requiresExplicitSubscribe:!1,subscriptionParameters:null},i=function(t){e(t)&&o.g.importAndExecute(n,i)},[4,o.f.import()];case 1:return r.sent()(n,i),[4,o.b.import()];case 2:return c=r.sent()(),[2,[t,n,i,c]]}})})}n.d(t,"a",function(){return i})},2542:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(788);function a(e){var t="";return e&&e.model&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2590:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",function(){return r})},2672:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")(function(e,t){e.shouldShowContextMenu=t})},2685:function(e,t,n){"use strict";var r=n(1591),a=n(0),o=n(1084),i=n(860);var c=n(3097);function s(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e.strategy.previewMethod!==i.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===i.a.Wac&&(r.previewMethod=i.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter(function(e){return e!==o.a.Preview})),n.label=2;case 2:return[2]}var r})})}var u=n(2295),d=n(911),l=n(2499),p=n(813);function m(e,t,n,a,o,i,c,m,f){void 0===c&&(c=null),void 0===f&&(f=!1),Object(l.a)([{attachmentId:e,attachment:t}],n,o);var h=Object(p.a)(e),v=Object(u.a)(e,n,a,1===h.type,d.a.Unknown,!1,c);return Object(r.a)(v,h,!1,m,i),f&&s(v),v}n.d(t,"a",function(){return m})},2828:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}},2829:function(e,t,n){"use strict";var r=n(958),a=n(43);t.a=Object(a.action)("deleteAttachment")(function(e){Object(r.a)().attachments.delete(e.Id)})},2862:function(e,t,n){"use strict";var r=n(0),a=n(829),o=n(813),i=n(1807),c=n(1235);function s(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(s=Object(o.a)(e))?Object(a.e)(s.model)?[4,c.e.import()]:[3,2]:[2];case 1:return r.sent()(s.model),[3,3];case 2:(u=s.download.url)&&Object(i.b)(u,t,n),r.label=3;case 3:return[2]}})})}var u=n(22),d=n(877);n.d(t,"c",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"a",function(){return d.c}),n.d(t,"b",function(){return s});var l=new u.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(10),n.e(128)]).then(n.bind(null,14026))}),p=new u.a(l,function(e){return e.clickAttachment}).importAndExecute,m=new u.a(l,function(e){return e.previewAttachment})},2928:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",function(){return r})},2971:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(774),a=n.n(r),o=n(2972),i=n.n(o),c=n(2974),s=n.n(c),u=n(818),d=n.n(u),l=n(239);function p(e,t,n){return i()({Header:Object(l.getJsonRequestHeader)(),Body:s()({Content:e,ImportedItemFolderId:d()({BaseFolderId:a()({Id:t})}),AttachmentId:n})},{datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}}).then(function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")})}},2972:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(2973);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("ImportCalendarEvent",e,t)}},2973:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},e)}},2974:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ImportCalendarEventRequest:#Exchange"},e)}},3036:function(e,t,n){"use strict";var r=n(0),a=n(2);var o=Object(a.action)("saveAttachmentsToCloud",function(e,t,n,r,a,o,i,c){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:a,folderId:o,attachmentIds:i,showProgressBar:c}}),i=n(175),c=n(2828),s=n.n(c),u=n(3519),d=n.n(u);function l(e,t,n,r,a,o,c){var u=function(e,t,n,r,a,o,i){return s()({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:o,attachmentIds:i})}(e,t,n,r,a.type===i.a.GroupMailbox?a.deprecatedMailboxId:null,o,c);return d()({requestObject:u},a.requestOptions)}var p=n(2504),m=n(1051),f=n(829),h=n(228),v={},b=5e3,g=12;function O(e,t,n,a,o){var i=new h.a("SaveToCloudProgressManager"),c=setInterval(function(){!function(e,t,n,a,o,i,c){Object(r.__awaiter)(this,void 0,void 0,function(){var s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(s=c[e])?(s.counter++,s.counter>i?(w(e,c),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),o&&o(),[2]):[4,f.g.import()]):[2];case 1:return r.sent()(t,n,e,0,function(e){a&&a(e.NotificationPayloads)}),[2]}})})}(n,e,t,a,o,g,v)},b);v[n]={timer:c,counter:0,datapoint:i}}function w(e,t){void 0===t&&(t=null),t||(t=v);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}Object(a.orchestrator)(o,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,o,i,c,s,u;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),a=function(r){if(!r)return!1;if(23===r.ResultCode)return!1;var a=e.notificationHandler(r);return t&&a&&(w(n.Id),t=!1),a},[4,Object(p.a)(a)];case 1:return o=r.__read.apply(void 0,[d.sent(),4]),i=o[0],c=o[1],s=o[2],u=o[3],function(e,t,n,a,o,i,c,s,u){Object(r.__awaiter)(this,void 0,void 0,function(){var d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l(e?e.Id:null,t?t.Id:null,n,i,_(t,e,u),s,u?u.map(function(e){return e.Id}):null)];case 1:return[2,r.sent()];case 2:return d=r.sent(),c(d,1,"ServerError"),m.g.importAndExecute(a,o),[2,null];case 3:return[2]}})})}(e.attachmentId,e.itemId,i,c,s,u,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&O(e.attachmentId,e.itemId,n.Id,function(e){e.forEach(function(e){a(e)})},function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")}),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,c,s),[2]}})})});function _(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}var j=Object(a.action)("cancelSaveAttachmentsToCloud",function(e){return{operationId:e}});Object(a.orchestrator)(j,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return w(e.operationId),[2]})})});n.d(t,"b",function(){return o}),n.d(t,"a",function(){return j})},3069:function(e){e.exports={a:"lbb"}},3097:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),a=n(228),o=n(2222),i=n(3098),c={},s={},u=[],d=0,l=2;function p(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,c;return Object(r.__generator)(this,function(s){return i=new a.a("InitializeWacUrl"),n&&i.addCustomProperty("actionSource",n),(c=f(e,t,i))?[2,c]:[2,new Promise(function(a,c){var s={attachmentId:e,isEdit:t,actionSource:n,datapoint:i,resolve:a,reject:c};o?m(s):(u.push(s),function e(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:if(!u.length)return[2];if(d>=l)return[2];t=u.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}})})}())})]})})}function m(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,u,d,l,p,m,h;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=e.attachmentId,n=e.isEdit,a=e.actionSource,u=e.datapoint,d=e.resolve,l=e.reject,p=f(t,n,u))return d(p),[2];u.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(i.a)(t.Id,n,null,t.mailboxInfo&&t.mailboxInfo.requestOptions,a)];case 2:return 0===(m=r.sent()).Status&&((n?s:c)[t.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||u.addCustomProperty("WacUrlIsEmpty",!0),u.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),u.end(),d(m),[3,4];case 3:return h=r.sent(),Object(o.a)(h)&&Object(o.c)(u,h.response),Object(o.d)(u,h.toString()),u.endWithError("ServerError"),l(h),[3,4];case 4:return[2]}})})}function f(e,t,n){var r=t?s:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},3098:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1741),a=n.n(r);function o(e,t,n,r,o){if(o){var i="getWacAttachmentInfo"+o;(r=r||{}).headers=r.headers||new Headers,r.headers.set("X-OWA-ActionName",i)}return a()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},3099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3100:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}},3101:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FileAttachment:#Exchange"},e)}},3103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}},3336:function(e,t,n){"use strict";var r=n(813),a=n(43);t.a=Object(a.action)("setAttachmentOriginalUrl")(function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t})},3519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(2828);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("SaveAttachmentsToCloud",e,t)}},3770:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(22),a=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(10),n.e(128)]).then(n.bind(null,6491))}),o=Object(r.d)(a,function(e){return e.AttachmentThumbnailView}),i=Object(r.d)(a,function(e){return e.AttachmentIconView}),c=Object(r.d)(a,function(e){return e.AttachmentDocInfoView})},3844:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(3099);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("ConvertLocalToRefAttachment",e,t)}},3845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(3100);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("CancelConvertLocalToRefAttachment",e,t)}},3846:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(3101);t.default=function(e,t){return void 0===e.requestObject||e.requestObject.__type||(e.requestObject=a.default(e.requestObject)),r.makeServiceRequest("ConvertRefToLocalAttachment",e,t)}},3847:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(3103);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("CancelConvertRefToLocalAttachment",e,t)}},4022:function(e){e.exports={a:"jMb"}},4183:function(e){e.exports={a:"BWa"}},4184:function(e){e.exports={a:"Urb"}},4634:function(e){e.exports={a:"MLb"}},4970:function(e,t,n){"use strict";var r=n(0),a=n(4184),o=n(4634),i=n(4),c=n(173),s=n(287),u=n(77),d=n(228),l=n(1176),p=n(6327),m=n(5707),f=n(6328),h=n(829),v=n(813),b=n(2542),g=n(1807),O=n(1235),w=n(877),_=n(25),j=n(1),I=n(4971),x=n(2928),C=n(105),y=n(324),S=n(7395),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyDown=function(e){e.keyCode!==u.a.enter&&e.keyCode!==u.a.space||(_.d.info("AttachmentSurfaceActionButton.keyDown enter|space"),e.stopPropagation(),t.props.isForAddToCalendar?Object(f.a)(t.props.attachmentViewState,m.a.SurfaceAction):t.downloadAttachment())},t.handleOnFocus=function(){return Object(I.b)(t.props.attachmentViewState,t.props.isForImageView)},t.handleOnBlur=function(){t.props.shouldNotHandleOnBlur||Object(I.a)(t.props.attachmentViewState,t.props.isForImageView)},t.onClickButton=function(e){_.d.info("AttachmentSurfaceActionButton.onclick"),e.stopPropagation(),t.props.isForAddToCalendar?Object(f.a)(t.props.attachmentViewState,m.a.SurfaceAction):t.downloadAttachment()},t.downloadAttachment=function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return(e=Object(v.a)(this.props.attachmentViewState.attachmentId))?(Object(d.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:this.props.attachmentViewState.isCloudy,isCompose:!this.props.attachmentViewState.isReadOnly},{cosmosOnlyData:JSON.stringify({size:e.model.Size,fileType:Object(b.a)(e),attachmentId:e.model.AttachmentId&&e.model.AttachmentId.Id})}),Object(h.e)(e.model)?[4,O.e.import()]:[3,2]):(_.d.error("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null"),[2]);case 1:return t.sent()(e.model),[3,3];case 2:Object(g.b)(e.download.url,this.props.attachmentViewState.isCloudy,document.body),t.label=3;case 3:return[2]}})})},t}return Object(r.__extends)(t,e),t.prototype.render=function(){if(this.getShouldHideButton())return null;var e=void 0,t=this.getAttachmentStyle(this.props.previewState);e=this.props.isForImageView?y([S.downloadButton,S.downloadButtonForImageView,this.props.customClassName]):this.props.attachmentViewState.isReadOnly?y([S.downloadButton,t,this.props.customClassName]):y([S.downloadButton,t,S.downloadButtonForDocViewInCompose,this.props.customClassName]);var n=this.props.isForAddToCalendar?"AddEvent":"Download",r=this.props.isForAddToCalendar?Object(i.a)(o.a):Object(i.a)(a.a);return j.createElement(s.a,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.keyDown,ariaLabel:r,title:r,onClick:this.onClickButton,className:e,iconProps:{iconName:n,styles:{root:S.icon}}})},t.prototype.getShouldHideButton=function(){var e=this.props.attachmentViewState;return!Object(x.a)(l.a.Download,e)||!Object(p.a)(e)||0!==e.ongoingAction||!this.props.attachmentViewState.strategy.showActionsMenu},t.prototype.getAttachmentStyle=function(e){switch(e){case w.a.Edit:return Object(C.e)("doc-attachment-editingVisualFeature")?S.editWithVisualFeature:S.edit;case w.a.NotSelectedAndSaving:return S.notSelectedAndSaving;case w.a.OtherSaving:return S.attachmentView;case w.a.Selected:return S.selected;case w.a.SelectedAndPending:return S.selectedAndPending;case w.a.SelectedAndSaving:return S.selectedAndSaving;default:return S.default}},t=Object(r.__decorate)([c.observer],t)}(j.Component);t.a=A},4971:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return l});var r=n(6329),a=n(1943),o=n(2590),i={},c=null;function s(e,t){i[e.attachmentId.Id]&&(clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(o.a)(e)&&Object(a.a)(e,!0)}function u(e,t){i[e.attachmentId.Id]&&clearTimeout(i[e.attachmentId.Id]),i[e.attachmentId.Id]=setTimeout(function(){Object(r.a)(e,!1),t&&!Object(o.a)(e)&&Object(a.a)(e,!1),e.attachmentId.Id===c&&(c=null),i[e.attachmentId.Id]=null},40)}function d(e,t){Object(r.a)(e,!0),t&&!Object(o.a)(e)&&Object(a.a)(e,!0)}function l(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(o.a)(e)&&Object(a.a)(e,!1))}},4972:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:function(e){return[e]}}}},5058:function(e,t,n){"use strict";var r=n(720),a=n(0),o=n(1),i=n(353),c=Object(i.a)(),s=.01,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderProgress=function(e){var n=t.props,r=n.ariaValueText,a=n.barHeight,i=n.className,u=n.styles,d=n.theme,l="number"==typeof t.props.percentComplete?Math.min(100,Math.max(0,100*t.props.percentComplete)):void 0,p=c(u,{theme:d,className:i,barHeight:a,indeterminate:void 0===l}),m={width:void 0!==l?l+"%":void 0,transition:void 0!==l&&l<s?"none":void 0},f=void 0!==l?0:void 0,h=void 0!==l?100:void 0,v=void 0!==l?Math.floor(l):void 0;return o.createElement("div",{className:p.itemProgress},o.createElement("div",{className:p.progressTrack}),o.createElement("div",{className:p.progressBar,style:m,role:"progressbar","aria-valuemin":f,"aria-valuemax":h,"aria-valuenow":v,"aria-valuetext":r}))},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,r=e.label,i=void 0===r?this.props.title:r,s=e.description,u=e.styles,d=e.theme,l=e.progressHidden,p=e.onRenderProgress,m=void 0===p?this._onRenderProgress:p,f="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,h=c(u,{theme:d,className:n,barHeight:t,indeterminate:void 0===f});return o.createElement("div",{className:h.root},i?o.createElement("div",{className:h.itemName},i):null,l?null:m(a.__assign({},this.props,{percentComplete:f}),this._onRenderProgress),s?o.createElement("div",{className:h.itemDescription},s):null)},t.defaultProps={label:"",description:"",width:180},t}(o.Component),d=n(11),l=n(273),p={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},m=Object(d.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}}),f=Object(d.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}});n.d(t,"a",function(){return h});var h=Object(r.a)(u,function(e){var t,n,r=Object(l.a)(),a=e.className,o=e.indeterminate,i=e.theme,c=e.barHeight,s=void 0===c?2:c,u=i.palette,h=i.semanticColors,v=i.fonts,b=Object(d.getGlobalClassNames)(p,i),g=u.neutralLight;return{root:[b.root,v.medium,a],itemName:[b.itemName,d.noWrap,{color:h.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[b.itemDescription,{color:h.bodySubtext,fontSize:v.small.fontSize,lineHeight:18}],itemProgress:[b.itemProgress,{position:"relative",overflow:"hidden",height:s,padding:"8px 0"}],progressTrack:[b.progressTrack,{position:"absolute",width:"100%",height:s,backgroundColor:g,selectors:(t={},t[d.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:u.themePrimary,height:s,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[d.HighContrastSelector]={backgroundColor:"WindowText"},n)},o?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+g+" 0%, "+u.themePrimary+" 50%, "+g+" 100%)",animation:(r?f:m)+" 3s infinite"}:{transition:"width .15s linear"},b.progressBar]}},void 0,{scope:"ProgressIndicator"})},5136:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1534),a=n(792);function o(e){if(e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE){var t=e;return{fileType:a.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.__type}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE}}},5707:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},5793:function(e){e.exports={a:"AMb"}},5794:function(e){e.exports={a:"zIb"}},5968:function(e,t,n){"use strict";function r(e,t){var n,r,a=(n=e,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=a?a:t}var a=n(6286),o=n(788);function i(e,t){var n=t.model.Name;if(e.isCloudy){var r=t;if(r.openUrl)n+="\n \n"+r.openUrl;else{var a=t.model;a.AttachLongPathName&&(n+="\n \n"+a.AttachLongPathName)}}return n}function c(e,t){if(e.isCloudy){var n=t.model;if(e.isReadOnly)return{text:r(t.openUrl,n.AttachLongPathName||null),title:null};var i=t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate,c=Object(a.a)(n.PermissionType,n.ProviderType,i,e.isPlaceholderAttachment);return{text:c,title:c}}var s=t.model.Size>0?Object(o.g)(t.model.Size):null;return{text:s,title:s}}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},6286:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(7321),a=n(4),o=n(2173),i=n(105),c=n(7);function s(e,t,n,s){return void 0===n&&(n=null),void 0===s&&(s=!1),null==e||s?null:Object(i.e)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(c.Bb)(n,Object(c.Kb)())?Object(a.b)(Object(a.a)(r.a),n):Object(o.e)(e,t)}},6326:function(e){e.exports={a:"WLb"}},6327:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(829),a=n(813);function o(e){var t=Object(a.a)(e.attachmentId);return!!t&&(!!Object(r.e)(t.model)||t.download.url&&t.info&&t.info.allowDownload)}},6328:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h});var r=n(4634),a=n(4),o=n(228),i=n(1176),c=n(2470),s=n(1133),u=n(5707),d=n(813),l=n(2542),p=n(105),m=n(2928);function f(e,t){var n=Object(d.a)(e.attachmentId),r=Object(l.a)(n);Object(o.o)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(s.a)(e,0,15):(Object(i.z)(Object(i.i)(n.model.Size),.1,function(t){Object(i.v)(e,t)},e.attachmentId),Object(c.a)(e,0))}function h(e){var t=Object(d.a)(e.attachmentId);return Object(m.a)(i.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass&&Object(p.e)("cal-ics-preview")?{name:Object(a.a)(r.a),key:"AddToCalendar",onClick:function(){f(e,u.a.ContextMenu)}}:null}},6329:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setShouldShowActionsContainer")(function(e,t){e.shouldShowActionsContainer=t})},7321:function(e){e.exports={a:"gMb"}},7392:function(e){e.exports={a:"LLb"}},7394:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"d",function(){return s});var r=n(4970);n.d(t,"a",function(){return r.a});var a=n(22),o=n(4972);n.d(t,"c",function(){return o.a});var i=new a.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(10),n.e(128)]).then(n.bind(null,9089))}),c=Object(a.d)(i,function(e){return e.AttachmentView}),s=new a.b(i,function(e){return e.getContextMenus})},7395:function(e,t,n){var r=n(7396),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)a.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},7396:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._3QZNNyRu4bsfxs-OL7OQfF{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:25px;width:26px}html[dir] ._3QZNNyRu4bsfxs-OL7OQfF{padding:4px;text-align:center}._3QZNNyRu4bsfxs-OL7OQfF:focus,._3QZNNyRu4bsfxs-OL7OQfF:hover,._3OW4PWuPDMXJ3j1YO3R8q_{color:"[theme:neutralSecondary, default:#666666]"}._3OW4PWuPDMXJ3j1YO3R8q_{display:block}._9IveE8fsson3asxDhih-X{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X{right:26px}html[dir=rtl] ._9IveE8fsson3asxDhih-X{left:26px}._9IveE8fsson3asxDhih-X:focus,._9IveE8fsson3asxDhih-X:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._9IveE8fsson3asxDhih-X:focus,html[dir] ._9IveE8fsson3asxDhih-X:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._9IveE8fsson3asxDhih-X:focus,html[dir=ltr] ._9IveE8fsson3asxDhih-X:hover{border-bottom-right-radius:2px}html[dir=rtl] ._9IveE8fsson3asxDhih-X:focus,html[dir=rtl] ._9IveE8fsson3asxDhih-X:hover{border-bottom-left-radius:2px}._3YIYA63PW-wIVkxR2Su9w3{font-size:14px}html[dir] ._3YIYA63PW-wIVkxR2Su9w3{margin:0}html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:focus,html[dir] ._1-hVXxvfDp0xe0VVvmfkXI:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .tbC07jvl9ABO08CjRkR9G,html[dir] .u4MtH9lbDLor4YGZBCHkj,html[dir] .pjl51ZJco7p4lHev54DwN,html[dir] .hnWaZkVaaCryiaMDmw1gh,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] .tbC07jvl9ABO08CjRkR9G:focus,html[dir] .tbC07jvl9ABO08CjRkR9G:hover,html[dir] .u4MtH9lbDLor4YGZBCHkj:focus,html[dir] .u4MtH9lbDLor4YGZBCHkj:hover,html[dir] .pjl51ZJco7p4lHev54DwN:focus,html[dir] .pjl51ZJco7p4lHev54DwN:hover,html[dir] .hnWaZkVaaCryiaMDmw1gh:focus,html[dir] .hnWaZkVaaCryiaMDmw1gh:hover,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:focus,html[dir] ._2WYO4FLw4GnoQDNjqX1tF0:hover,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:focus,html[dir] ._2mWLOTqEFbyTpIo_Dy3kO6:hover,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:focus,html[dir] ._3Rg1o7_N0DLI2zwxeFuP5-:hover{background:"[theme:themeTertiary, default:#71AFE5]"}html[dir] .u4MtH9lbDLor4YGZBCHkj{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}',""]),t.locals={downloadButton:"_3QZNNyRu4bsfxs-OL7OQfF",downloadButtonForDocViewInCompose:"_3OW4PWuPDMXJ3j1YO3R8q_",downloadButtonForImageView:"_9IveE8fsson3asxDhih-X",icon:"_3YIYA63PW-wIVkxR2Su9w3",default:"_1-hVXxvfDp0xe0VVvmfkXI",edit:"tbC07jvl9ABO08CjRkR9G",editWithVisualFeature:"u4MtH9lbDLor4YGZBCHkj",notSelectedAndSaving:"pjl51ZJco7p4lHev54DwN",selected:"hnWaZkVaaCryiaMDmw1gh",selectedAndPending:"_2WYO4FLw4GnoQDNjqX1tF0",selectedAndSaving:"_2mWLOTqEFbyTpIo_Dy3kO6",thematic:"_3Rg1o7_N0DLI2zwxeFuP5-"}},7636:function(e){e.exports={j:"kMb",k:"lMb",l:"mMb",h:"nMb",i:"oMb",f:"pMb",g:"qMb",n:"rMb",o:"sMb",p:"tMb",b:"uMb",m:"vMb",d:"wMb",c:"xMb",a:"yMb",e:"zMb"}},7637:function(e,t,n){"use strict";function r(e){return e.actionCompletePercent>0&&e.actionCompletePercent<=1}n.d(t,"a",function(){return r})},8206:function(e,t,n){"use strict";var r=n(0),a=n(829),o=n(25);function i(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,c,s,u,d,l,p,m,f,h;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=[],[4,a.i.import()];case 1:return i=r.sent(),[4,a.l.import()];case 2:return c=r.sent(),t?[4,a.o.import()]:[3,4];case 3:return u=r.sent(),[3,5];case 4:u=null,r.label=5;case 5:s=u,d=t?e.docViewAttachments:e.imageViewAttachments,l=0,r.label=6;case 6:if(!(l<d.length))return[3,12];if(p=d[l],m=i(p.attachmentId),t&&!s(m.model))return[3,11];r.label=7;case 7:return r.trys.push([7,9,,10]),[4,c(p.attachmentId,e.isReadOnly)];case 8:return r.sent(),[3,10];case 9:return f=r.sent(),o.d.warn("Unable to refresh thumbnail image for "+p.attachmentId+". Got error "+f),[3,10];case 10:h={downloadUrl:m.download.url,id:p.attachmentId,previewUrl:m.previewImage.url,thumbnailUrl:m.thumbnailImage.url},n.push(h),r.label=11;case 11:return l++,[3,6];case 12:return[2,n]}})})}n.d(t,"a",function(){return i})},8222:function(e,t,n){"use strict";var r=n(4022),a=n(3069),o=n(5793),i=n(6326),c=n(7636),s=n(4183),u=n(4),d=n(7);function l(e){return e&&e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate&&Object(d.Bb)(e.info.sharingInfo.expirationDate,Object(d.Kb)())}var p=n(218),m=n(881),f=n(105),h=n(175),v=n(276),b=n(5968);function g(e,t){return t?Object(u.a)(c.h):Object(u.b)(Object(u.a)(c.i),e?Object(u.a)(i.a):Object(u.a)(s.a))}function O(e,t){var n,d=Object(v.a)(),O=void 0!==t.id.mailboxInfo&&t.id.mailboxInfo.type==h.a.GroupMailbox;if(0===e.actionMessage)return function(e,t){var n=Object(b.b)(e,t);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(f.e)("doc-attachment-referenceAttachmentExpiration")&&l(t)}}(e,t);var w=!1,_=!1;switch(e.actionMessage){case 1:n=function(e,t){if(t)return Object(u.a)(c.j);var n=Object(m.f)();return e?Object(u.b)(Object(u.a)(c.k),Object(u.a)(i.a)):Object(u.b)(Object(u.a)(c.l),n)}(d,O);break;case 5:n=Object(u.a)(c.b);break;case 2:n=g(d,O);break;case 3:n=g(d,O),w=!0;break;case 4:case 9:n=function(e,t){return t?Object(u.a)(c.f):Object(u.b)(Object(u.a)(c.g),e?Object(u.a)(i.a):Object(u.a)(s.a))}(d,O),_=!0;break;case 7:n=Object(u.a)(c.m);break;case 6:n=Object(u.a)(c.d);break;case 8:n=function(e,t){if(t)return Object(u.a)(c.n);var n=Object(m.f)();return e?Object(u.b)(Object(u.a)(c.o),n,Object(u.a)(i.a)):Object(u.b)(Object(u.a)(c.p),n)}(d,O);break;case 10:n=Object(u.a)(c.c);break;case 11:n=Object(u.a)(c.a);break;case 12:n=Object(u.a)(c.e),_=!0;break;case 16:n=Object(u.a)(c.c);break;case 14:n=Object(u.a)(o.a),w=!0;break;case 15:n=Object(u.a)(a.a),_=!0;break;case 13:n=Object(u.a)(r.a);break;case 17:n=Object(u.a)(c.m);break;default:Object(p.a)(e.actionMessage)}return{text:n,title:n,shouldDisplaySuccessIcon:w,shouldDisplayFailureIcon:_,useExpiredAttachmentStyling:!1}}n.d(t,"a",function(){return O})},836:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",Todo:"todo",Attachment:"attachment"}},992:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return m});var r,a=n(1351),o=n(1114),i=n(788),c={};function s(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:-1===p.indexOf(e)?Object(a.a)(e+"_16x16"):Object(a.a)("generic_16x16")},c[e])}var u="generic",d=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":u,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),l=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),p=["gdoc","gform","gsheet","gslide"];function m(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c,p=Object(i.b)(e);return p&&(c=d[p.toLowerCase()]),!c&&n&&n in l&&(c=l[n]),s(c||u)}}},0,[6,7,9,10,128,13,46,124,564,341,23,119,227,421]]);
//# sourceMappingURL=owa.ConversationAttachment.js.map
self.scriptsLoaded['owa.ConversationAttachment.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ConversationAttachment.js'] = (new Date()).getTime();