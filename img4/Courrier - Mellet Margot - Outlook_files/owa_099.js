self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[271],{1208:function(e,t,n){"use strict";var i=n(720),o=n(0),r=n(1),a=n(353),s=n(210),c=n(398),u=Object(a.a)(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=r.createRef(),t._onClick=function(e){var n=t.props,i=n.onClick;n.disabled?e.preventDefault():i&&i(e)},t}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,i=t.children,a=t.className,s=t.href,l=t.theme,d=t.styles,p=t.keytipProps,f=u(d,{className:a,isButton:!s,isDisabled:n,theme:l}),b=this._getRootType(this.props);return r.createElement(c.a,{keytipProps:p,ariaDescribedBy:this.props["aria-describedby"],disabled:n},function(t){return r.createElement(b,o.__assign({},t,e._adjustPropsForRootType(b,e.props),{className:f.root,onClick:e._onClick,ref:e._link,"aria-disabled":n}),i)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,i=t.target,r=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,o.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef"]));return"string"==typeof e?"a"===e?o.__assign({target:i,href:n?void 0:r},a):"button"===e?o.__assign({type:"button",disabled:n},a):o.__assign({},a,{disabled:n}):o.__assign({target:i,href:r,disabled:n},a)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(s.a),d=n(11),p={root:"ms-Link"};n.d(t,"a",function(){return f});var f=Object(i.a)(l,function(e){var t,n,i,o=e.className,r=e.isButton,a=e.isDisabled,s=e.theme,c=s.semanticColors,u=c.link,l=c.linkHovered,f=c.disabledText,b=c.focusBorder,h=Object(d.getGlobalClassNames)(p,s);return{root:[h.root,s.fonts.medium,{color:u,outline:"none",fontSize:"inherit",fontWeight:"inherit",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+b+" inset",selectors:(n={},n[d.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[d.HighContrastSelector]={borderBottom:"none"},t)},r&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(i={},i[d.HighContrastSelectorBlack]={color:"#FFFF00"},i[d.HighContrastSelectorWhite]={color:"#00009F"},i)},!r&&{textDecoration:"none"},a&&["is-disabled",{color:f,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!a&&{selectors:{"&:active, &:hover, &:active:hover":{color:l,textDecoration:"underline"},"&:focus":{color:u}}},h.root,o]}},void 0,{scope:"Link"})},12459:function(e,t,n){var i=n(12460),o=n(58);"string"==typeof i&&(i=[[e.i,i]]);for(var r=0;r<i.length;r++)o.loadStyles(i[r][1],!1);i.locals&&(e.exports=i.locals)},12460:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,"._3n-f8Ap1Kc2GX9G5WkichB{font-weight:600;font-size:12px}html[dir=ltr] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 0 10px 10px}html[dir=rtl] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 10px 10px 0}html[dir=ltr] ._3FcKFiEljg6x-owcifZQA5{padding-left:15px}html[dir=rtl] ._3FcKFiEljg6x-owcifZQA5{padding-right:15px}",""]),t.locals={groupSectionHeader:"_3n-f8Ap1Kc2GX9G5WkichB",detailsList:"_3FcKFiEljg6x-owcifZQA5"}},9108:function(e,t,n){"use strict";n.r(t);var i=n(2),o=Object(i.action)("addDiagnosticsData",function(e,t,n){return{groupId:e,actionType:t,customData:n}}),r=n(6),a=Object(i.createStore)("groupsReadUnreadDiagnosticsStore",{diagnosticsMap:new r.ObservableMap})(),s=(Object(i.mutator)(o,function(e){var t=e.groupId,n=e.actionType,i=e.customData,o={group:t,actionType:n,timestamp:new Date(Date.now()).toLocaleTimeString(),customData:i};if(a.diagnosticsMap.has(t)){var r=a.diagnosticsMap.get(t);r.push(o),r.length>20&&r.splice(0,1)}else a.diagnosticsMap.set(t,[o])}),n(0)),c=Object(i.action)("addMarkAsReadDiagnostics",function(e,t,n,i,o){return{tableQuery:e,isActingOnAllItemsInTable:t,isReadValueToSet:n,actionSource:i,itemsToUpdate:o}}),u=Object(i.action)("addUnreadCountNotificationDiagnostics",function(e,t){return{groupId:e,notification:t}}),l=Object(i.action)("addUnreadCountSubscriptionDiagnostics",function(e,t,n){return{groupId:e,subscription:t,isUnsubscribe:n}}),d=n(19),p=n(1),f=n.n(p),b=n(5069),h=n(1762),g=n(2153),m=n(12459),_=[{key:"timestamp",minWidth:80,name:"Time",fieldName:"timestamp",isResizable:!0},{key:"actionType",minWidth:150,name:"Action",fieldName:"actionType",isResizable:!0},{key:"customData",minWidth:650,name:"Details",fieldName:"customData",isResizable:!0}],v=function(e,t,n){return p.createElement("span",null,e[n.key])},y=Object(d.a)(function(){if(0==a.diagnosticsMap.size)return null;var e=Object(s.__spread)(a.diagnosticsMap.keys()).sort(function(e,t){return e.localeCompare(t)}),t=[];return e.forEach(function(e){t.push(p.createElement("div",{className:m.groupSectionHeader},e)),t.push(p.createElement(b.a,{className:m.detailsList,items:a.diagnosticsMap.get(e),columns:_,layoutMode:h.e.fixedColumns,selectionMode:g.c.none,constrainMode:h.d.unconstrained,onRenderItemColumn:v}))}),p.createElement("div",{className:"allowTextSelection"},t)}),k=n(1369),j=!1,x={name:"Groups read/unread",datapoints:[],type:"Custom"},w=function(){return f.a.createElement(y)};function O(){return Object(s.__awaiter)(this,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return j?[3,2]:(j=!0,[4,k.e.import().then(function(e){k.f.importAndExecute(x,e(),w)})]);case 1:e.sent(),e.label=2;case 2:return[2]}})})}var S=n(854),C=n(755);Object(i.orchestrator)(c,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,r,a,c,u;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return t=e.tableQuery,n=e.isActingOnAllItemsInTable,i=e.isReadValueToSet,r=e.actionSource,a=e.itemsToUpdate,Object(S.e)(t)?(c=function(e,t){return e?t?"MarkAllAsRead":"MarkAllAsUnread":t?"MarkAsRead":"MarkAsUnread"}(n,i),u="ListViewType: "+Object(C.x)(t.listViewType)+", ActionSource: "+r,a&&(u+=", Count: "+a.length),[4,O()]):[3,2];case 1:s.sent(),o(t.folderId,c,u),s.label=2;case 2:return[2]}})})}),Object(i.orchestrator)(u,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,r;return Object(s.__generator)(this,function(a){switch(a.label){case 0:return t=e.groupId,n=e.notification,i=n.EventType?n.EventType:"Unknown",r="UnreadCount: "+n.UnreadCount+", EventType: "+i+", NotificationId: "+n.NotificationId+", BrokerSubscriptionId: "+n.BrokerSubscriptionId,[4,O()];case 1:return a.sent(),o(t,"UnreadCountNotification",r),[2]}})})}),Object(i.orchestrator)(l,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,r,a;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return t=e.groupId,n=e.subscription,i=e.isUnsubscribe,r=i?"Unsubscribe":"Subscribe",a="ChannelId: "+n.subscriptionParameters.ChannelId,[4,O()];case 1:return s.sent(),o(t,r,a),[2]}})})}),n.d(t,"addMarkAsReadDiagnostics",function(){return c}),n.d(t,"addUnreadCountNotificationDiagnostics",function(){return u}),n.d(t,"addUnreadCountSubscriptionDiagnostics",function(){return l})}},0,[0,1,3,6,201,532,182,23,119]]);
//# sourceMappingURL=owa.GroupsReadUnreadDiagnostics.js.map
self.scriptsLoaded['owa.GroupsReadUnreadDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();