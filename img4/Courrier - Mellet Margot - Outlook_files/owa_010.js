self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[421],{11583:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(199),i=t(8654);n.default=function(e,n){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetSharingInformation",e,n)}},11584:function(e){e.exports={b:"Tca",a:"Uca"}},11585:function(e){e.exports={h:"$ba",i:"aca",j:"bca",d:"cca",k:"dca",e:"eca",g:"fca",n:"gca",o:"hca",f:"ica",l:"jca",m:"kca",a:"lca",c:"mca",b:"nca"}},1170:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={}))},1430:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.To=1]="To",e[e.Cc=2]="Cc",e[e.Bcc=3]="Bcc"}(r||(r={}))},174:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"c",function(){return s}),t.d(n,"e",function(){return o}),t.d(n,"b",function(){return c}),t.d(n,"a",function(){return u});var r=t(22),i=(t(280),new r.c(function(){return t.e(362).then(t.bind(null,697))})),a=(new r.a(i,function(e){return e.makeOwsPrimeRequest}).importAndExecute,new r.a(i,function(e){return e.makePostRequest}).importAndExecute),s=new r.a(i,function(e){return e.makePatchRequest}).importAndExecute,o=new r.a(i,function(e){return e.makePutRequest}).importAndExecute,c=new r.a(i,function(e){return e.makeGetRequest}).importAndExecute,u=new r.a(i,function(e){return e.makeDeleteRequest}).importAndExecute},185:function(e,n,t){"use strict";var r=t(370);t.d(n,"a",function(){return r.a})},280:function(e,n,t){"use strict";t.d(n,"b",function(){return r}),t.d(n,"a",function(){return i});var r="owsserver",i="owsapi"},3361:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(174),a="ows/api/beta/sharinglink/info";function s(e,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(i.d)(a,{url:e},void 0,n)];case 1:return[2,t.sent()]}})})}var o,c,u=t(218),l=t(105),f=t(185),d=t(8654),g=t.n(d),h=t(7378),m=t.n(h),p=t(11583),b=t.n(p),O=t(25);function S(e){return Object(l.e)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t,i,a,u,l,d,g,h,p,b,S;return Object(r.__generator)(this,function(j){switch(j.label){case 0:return[4,s(e,!0)];case 1:return n=j.sent(),Object(f.a)(n.status)?(a=(i=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===o.OneDrivePro}(t=a.apply(i,[j.sent()])))return u=Object(r.__read)(t.sharingLinks.filter(function(e){return e.type===c.AnonymousEdit}),1),l=u[0],d=Object(r.__read)(t.sharingLinks.filter(function(e){return e.type===c.AnonymousView}),1),g=d[0],h=Object(r.__read)(t.sharingLinks.filter(function(e){return e.type===c.OrganizationEdit}),1),p=h[0],b=Object(r.__read)(t.sharingLinks.filter(function(e){return e.type===c.OrganizationView}),1),S=b[0],[2,m()({AccessRequestMode:t.accessRequestMode,AnonymousEditLink:l?l.url:void 0,AnonymousViewLink:g?g.url:void 0,CanCreateAnonymousEditLink:t.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:t.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:t.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:t.canCreateOrganizationViewLink,CanShareExternally:t.canShareExternally,CanShareInternally:t.canShareInternally,CanonicalUrl:t.canonicalUrl,ExpirationDate:t.expirationTime,FileName:t.name,IsAnonymousEditLinkAvailable:!!l,IsAnonymousViewLinkAvailable:!!g,IsOrganizationEditLinkAvailable:!!p,IsOrganizationViewLinkAvailable:!!S,MimeType:void 0,OrganizationEditLink:p?p.url:void 0,OrganizationViewLink:S?S.url:void 0,ResultCode:0,SharingLinkKind:v(t.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,m()({ResultCode:4})]:400===n.status?[2,m()({ResultCode:24})]:(O.d.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,m()({ResultCode:1})]);case 4:return[2]}})})}(e):b()(function(e){return g()({attachmentUrl:e})}(e))}function v(e){switch(e){case c.None:return 0;case c.View:case c.Edit:return 1;case c.AnonymousView:return 4;case c.AnonymousEdit:return 5;case c.OrganizationView:return 2;case c.OrganizationEdit:return 3;default:return Object(u.a)(e)}}!function(e){e.OneDrivePro="OneDrivePro"}(o||(o={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(c||(c={}));var j=t(4),x=t(11584),E=t(1240);var L=t(5618),I=t(4587),w=t(1691);function y(e,n,t){if(1!==e.length||null===t)return null;switch(n){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:case E.a.sharingWithLargeDL:return e[0].supportsDownsell?[t(e[0].id)]:null;case E.a.getSharingInfoFailed:case E.a.noPermissionSet:return null;case E.a.linkHasExpired:case E.a.linkWillExpire:return function(e){return[{text:Object(j.a)(I.a),action:function(){Object(w.a)(e.id)}},{text:Object(j.a)(L.a),action:function(){e.sharingTipsIgnored.push(E.a.linkHasExpired),e.sharingTipsIgnored.push(E.a.linkWillExpire)}}]}(e[0]);default:return Object(u.a)(n)}}var k=t(821);function P(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var A=t(1317);function R(e){return e.some(function(e){return e.totalMemberCount>A.g})}function C(e,n){return R(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function F(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function T(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var _=t(7);function D(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(_.Bb)(e.sharingInfo.expirationDate,Object(_.Kb)())}function M(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(_.zb)(e.sharingInfo.expirationDate,Object(_.Kb)())}var W=t(1613);function V(e){return e.recipientPermissionInfos.some(function(e){return e.getPermissionInfoStatus===W.a.Failed})}var z=t(3510);function G(e){switch(e){case A.m:case A.l:case A.c:case A.o:return!0;default:return!1}}function N(e){return e.filter(function(e){return e.totalMemberCount<=A.g&&G(e.recipient.persona.EmailAddress.MailboxType)})}function H(e){return N(e).some(function(e){return e.recipient.expansionStatus===z.a.Failed||e.recipient.expansionStatus===z.a.SucceededWithDLOrGroupMembers})}function q(e,n){return U(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded:0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===W.a.Succeeded})||(1===e.currentPermissionLevel||2===e.currentPermissionLevel)&&function(e){return e.recipientPermissionInfos.some(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===W.a.Succeeded})}(e.sharingRecipientsInfo)}function U(e,n){return!Object(l.e)("doc-attachment-contextualSharingTips")||R(n)||H(n)||V(e)}function B(e){return e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var K=t(1690);var $=t(228),Y=t(11585);var J=function(e){return e?e.filter(function(e){return e.totalMemberCount>100}).map(function(e){return e.recipient.persona.EmailAddress.Name}).join(", "):""};function Q(e,n,t){if(U(e,n))return Object(j.a)(Y.o);var r=e.recipientPermissionInfos,i=null,a=!1;if(0===t?(i=r.filter(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===W.a.Succeeded}),Object($.o)("RecipientCanNotAccess",{numOfRecipients:i.length})):1!==t&&2!==t||(a=!0,i=r.filter(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===W.a.Succeeded}),Object($.o)("RecipientCanNotHaveAccess",{numOfRecipients:i.length})),null!==i){var s=i.length,o=function(e){return e.map(function(e){return e.name?e.name:e.emailAddress}).join(", ")}(i.slice(0,3));return 1===s?Object(j.b)(Object(j.a)(a?Y.c:Y.l),o,"{0}"):s<4?Object(j.b)(Object(j.a)(a?Y.c:Y.m),o,"{0}"):Object(j.b)(Object(j.a)(a?Y.b:Y.a),o,"{0}")}return Object(j.a)(Y.o)}function X(e,n,t,r,i){if(!function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return!0;case E.a.getSharingInfoFailed:return Object(l.e)("doc-attachment-sharingInfoFailureTip");case E.a.linkWillExpire:case E.a.linkHasExpired:return Object(l.e)("doc-attachment-contextualSharingTips");default:return Object(u.a)(e)}}(n))return null;var a=function(e){switch(e){case E.a.noPermissionToShare:return B;case E.a.getSharingInfoFailed:return F;case E.a.linkHasExpired:return D;case E.a.linkWillExpire:return M;case E.a.externalRecipientCSL:return T;case E.a.noPermissionToShareExternally:return P;case E.a.noPermissionSet:return q;case E.a.sharingWithLargeDL:return C;default:return Object(u.a)(e)}}(n),s=e.filter(function(e){return a(e,t)});if(0===s.length)return null;var o=s.filter(function(e){return!Object(j.g)(e.name)}).map(function(e){return e.name}).join(", "),c=function(e,n,t){switch(e){case E.a.noPermissionToShare:return{singleFile:Object(j.a)(Y.h),multipleFiles:Object(j.a)(Y.h)};case E.a.getSharingInfoFailed:return{singleFile:Object(j.a)(Y.i),multipleFiles:Object(j.a)(Y.i)};case E.a.linkHasExpired:return{singleFile:Object(j.a)(Y.j),multipleFiles:Object(j.a)(Y.d)};case E.a.linkWillExpire:return{singleFile:Object(j.a)(Y.k),multipleFiles:Object(j.a)(Y.e)};case E.a.noPermissionToShareExternally:return{singleFile:Object(j.a)(Y.g),multipleFiles:Object(j.a)(Y.g)};case E.a.externalRecipientCSL:return{singleFile:Object(j.a)(Y.n),multipleFiles:Object(j.a)(Y.n)};case E.a.noPermissionSet:return{singleFile:Q(t[0].sharingRecipientsInfo,n,t[0].currentPermissionLevel),multipleFiles:Object(j.a)(Y.o)};case E.a.sharingWithLargeDL:var r=J(n);return{singleFile:Object(j.b)(Object(j.a)(Y.f),r,"{0}","{1}"),multipleFiles:Object(j.b)(Object(j.a)(Y.f),r,"{0}","{1}")};default:return Object(u.a)(e)}}(n,t,s),f=s.length>1?c.multipleFiles:c.singleFile;o&&0!==o.length||!f||0===f.length||O.d.error("file names should not be null or empty if the infobarStringTemplate is not");var d,g=y(s,n,i),h=function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:return[K.a.ignore,K.a.attachAsACopy];case E.a.getSharingInfoFailed:return[K.a.ignore];case E.a.externalRecipientCSL:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return[K.a.ignore,K.a.changePermission,K.a.attachAsACopy];case E.a.linkWillExpire:case E.a.linkHasExpired:return[K.a.ignore,K.a.refreshExpiration];default:return Object(u.a)(e)}}(n);if(r||null!==g&&0!==g.length)d=Object(j.b)(f,o);else{var m="",p=function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:return{singleFile:Object(j.a)(x.b),multipleFiles:Object(j.a)(x.a)};case E.a.getSharingInfoFailed:case E.a.linkHasExpired:case E.a.linkWillExpire:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return null;default:return Object(u.a)(e)}}(n);null!==p&&(m=s.length>1?p.multipleFiles:p.singleFile),d=Object(j.b)(f,o,m)}return{id:n,sharingTipString:d,actions:g,sharingTipActions:h,messageRank:function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.sharingWithLargeDL:case E.a.linkHasExpired:case E.a.externalRecipientCSL:case E.a.noPermissionSet:return k.b.Error;case E.a.linkWillExpire:case E.a.getSharingInfoFailed:return k.b.Info;default:return Object(u.a)(e)}}(n)}}function Z(e,n,t,r,i){var a=X(e,n,t,r,i);if(null===a)return null;var s={key:n,source:k.c.Compose,rank:a.messageRank,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map(function(e){s.messageParts.push(e)}),function(e){return s}}var ee=new Map;function ne(e){var n=[];ee.has(e)&&(n=ee.get(e)),te(n,[],e,"deleteLink")}function te(e,n,t,r){void 0===r&&(r=null);var i=n.filter(function(n){return-1===e.indexOf(n)}),a=e.filter(function(e){return-1===n.indexOf(e)}),s=r||"UnknownActionSource";i.unshift(s),a.unshift(s),i.length>1&&Object($.o)("LinkSharingTipsAdded",i,{cosmosOnlyData:t}),a.length>1&&Object($.o)("LinkSharingTipsRemoved",a,{cosmosOnlyData:t})}function re(e,n){var t,r,i,a=Object(E.b)().filter(function(n){return-1===e.sharingTipsIgnored.indexOf(n)}).map(function(t){return X([e],t,n,!0)}).filter(function(e){return null!==e});if("string"==typeof e.id){var s=a.map(function(e){return e.id});t=e.id,r=s,i=[],ee.has(t)&&(i=ee.get(t)),te(i,r,t),ee.set(t,r)}return a}function ie(e){switch(e){case A.f:case A.b:case A.i:case A.j:case A.a:case A.d:case A.h:return!0;default:return G(e)||function(e){switch(e){case A.n:case A.k:case A.p:return!0;default:return!1}}(e)||O.d.error("UnknownMailboxType: "+e),!1}}function ae(e){return e.filter(function(e){return e.totalMemberCount===A.e&&ie(e.recipient.persona.EmailAddress.MailboxType)})}t.d(n,"getSharingInformation",function(){return S}),t.d(n,"getInfoBarCreator",function(){return Z}),t.d(n,"getSharingIssuesForSharingData",function(){return re}),t.d(n,"hasGetRecipientPermissionFailed",function(){return V}),t.d(n,"hasLargeDLRecipient",function(){return R}),t.d(n,"hasRecipientExpansionFailure",function(){return H}),t.d(n,"getGroupsAndSmallDLs",function(){return N}),t.d(n,"getInvididualRecipients",function(){return ae}),t.d(n,"logSharingTipChangesForLinkRemoval",function(){return ne})},3510:function(e,n,t){"use strict";t.d(n,"c",function(){return o}),t.d(n,"d",function(){return c});var r=t(22),i=t(1430);t.d(n,"b",function(){return i.a});var a=t(1170);t.d(n,"a",function(){return a.a});var s=new r.c(function(){return t.e(389).then(t.bind(null,5953))}),o=new r.a(s,function(e){return e.setMembersToRecipientViewState}),c=new r.a(s,function(e){return e.setRecipientExpansionStatus})},370:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",function(){return r})},4587:function(e){e.exports={a:"Fda"}},5618:function(e){e.exports={a:"Eda"}},7378:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},821:function(e,n,t){"use strict";var r,i,a;t.d(n,"c",function(){return r}),t.d(n,"b",function(){return i}),t.d(n,"a",function(){return a}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},8654:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}}},0,[23,119]]);
//# sourceMappingURL=owa.SharingData.js.map
self.scriptsLoaded['owa.SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SharingData.js'] = (new Date()).getTime();